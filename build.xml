<project name="REXOS" default="dist" basedir=".">

  <property name="distdir" value="dist" />
  <property name="builddir" value="build~" />

  <property name="openBBS" value="openBBS.jar" />  
  <property name="autoKeyStoreServer" value="autoKeyStoreServer.jar" />
  <property name="autoKeyStoreJava" value="autoKeyStoreJava.jar" />
 <property name="blackboardServer" value="blackboardServer.jar" />

  <target name="init">
    <delete dir="${distdir}"/>
    <mkdir dir="${distdir}"/>
    <delete dir="${builddir}"/>
    <mkdir dir="${builddir}"/>
  </target>

 <!-- OPENBBS TARGET-->
  <target name="openBBS">
     <mkdir dir="${builddir}/openBBS"/>
    <javac
      srcdir="libraries/openBBS/src" 
      classpath="libraries/commons-lang-2.3.jar" 
      destdir="${builddir}/openBBS" 
      includeantruntime="true">
    </javac>
    <jar jarfile="dist/${openBBS}" basedir="${builddir}/openBBS"/>
  </target>

  <!-- AUTO KEYSTORE SERVER TARGET-->
  <target name="autoKeyStoreServer">
    <mkdir dir="${builddir}/autoKeyStoreServer"/>
    <javac 
      srcdir="tools/autoKeyStoreServer/src" 
      destdir="${builddir}/autoKeyStoreServer" 
      includeantruntime="true">
    </javac>
    <jar jarfile="dist/${autoKeyStoreServer}" basedir="${builddir}/autoKeyStoreServer">
      <manifest>  
        <attribute name="Main-Class" value="nl.hu.autokeystore.server.AutoKeyStoreServer" />  
      </manifest>  
    </jar>
  </target>

  <target name="autoKeyStoreJava">
    <mkdir dir="${builddir}/autoKeyStoreJava"/>
    <javac 
      srcdir="libraries/autoKeyStoreJava/src" 
      destdir="${builddir}/autoKeyStoreJava" 
      includeantruntime="true">
    </javac>
    <jar jarfile="dist/${autoKeyStoreJava}" basedir="${builddir}/autoKeyStoreJava"/>
  </target>

  <!-- AUTO KEYSTORE SERVER TARGET-->
  <target name="blackBoardServer" depends="autoKeyStoreJava, openBBS">
    <mkdir dir="${builddir}/blackboardServer"/>
    <javac 
      srcdir="libraries/blackboardServer/src" 
      destdir="${builddir}/blackboardServer"
      classpath="libraries/commons-lang-2.3.jar:libraries/protobuf-java-2.4.1.jar:dist/autoKeyStoreJava.jar:dist/openBBS.jar"
      includeantruntime="true">
    </javac>
    <jar jarfile="dist/${blackboardServer}" basedir="${builddir}/blackboardServer">
      <manifest>  
        <attribute name="Class-Path" value="../libraries/commons-lang-2.3.jar ../libraries/protobuf-java-2.4.1.jar autoKeyStoreJava.jar openBBS.jar"/> 
        <attribute name="Main-Class" value="nl.hu.blackboard.server.Main" /> 
      </manifest>  
    </jar>
  </target>



  <!-- ADD ALL LIBRARIES HERE-->
  <target name="build"  depends="init, openBBS, autoKeyStoreServer, autoKeyStoreJava, blackBoardServer">
      <delete dir="${builddir}"/>
  </target>



  <target name="clean"  description="clean up" >
    <!-- Delete the ${build} and ${dist} directory trees -->
    <delete dir="${distdir}"/>
    <delete dir="${builddir}"/>
  </target>
</project>